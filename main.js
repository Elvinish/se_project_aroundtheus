!function(){"use strict";class e{constructor(e,t,r,s,i){this._name=e.name,this._link=e.link,this._id=e.id,this._isLiked=e.isLiked||!1,this._cardSelector=t,this._handlePreviewPicture=r,this._handleDeleteCardClick=s,this._handleLikeClick=i}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeClick(this._id,this)})),this._trashButton.addEventListener("click",(()=>{this._handleDeleteCardClick(this._id,this)})),this._cardImage.addEventListener("click",(()=>{this._handlePreviewPicture({name:this._name,link:this._link})}))}handleDeleteCard(){this._cardElement.remove(),this.cardElement=null}setCardLike(e){this._isLiked=e,this._handleLikeIcon()}_handleLikeIcon(){this._isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}getView(){return this._cardElement=this._getTemplate(),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._cardImage=this._cardElement.querySelector(".card__image"),this._trashButton=this._cardElement.querySelector(".card__trash-button"),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._cardElement.querySelector(".card__title").textContent=this._name,this.setCardLike(this._isLiked,this._likes),this._setEventListeners(),this._cardElement}}var t=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e,t){const r=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),r.textContent=e.validationMessage,r.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}toggleButtonState(){if(this._hasInvalidInput())return this._submitButton.classList.add(this._inactiveButtonClass),void(this._submitButton.disabled=!0);this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_hasInvalidInput(){return!this._inputList.every((e=>e.validity.valid))}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_setEventListeners(){this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputList.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this.toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}};class r{constructor(e){this._popupElement=document.querySelector(e)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&"keydown"===e.type&&this.close()};setEventListeners(){this.closeButton=this._popupElement.querySelector(".modal__close"),this.closeButton.addEventListener("click",(()=>{this.close()})),this._popupElement.addEventListener("mousedown",(e=>{e.target.classList.contains("modal")&&this.close()}))}}class s extends r{constructor(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputList=this._popupElement.querySelectorAll(".modal__input"),this._submitButton=this._popupForm.querySelector(".modal__button"),this._initialButtonText=this._submitButton.textContent,this._shouldResetBeforeSubmit=r}open(){this._shouldResetBeforeSubmit&&this._popupForm.reset(),super.open()}getForm(){return this._popupForm}_getInputValues(){return this._inputValues={},this._inputList.forEach((e=>{this._inputValues[e.name]=e.value})),this._inputValues}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}_renderLoading(e){this._submitButton.textContent=e?"Saving...":this._initialButtonText}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._renderLoading(!0),this._handleFormSubmit({inputData:this._getInputValues(),form:this.getForm()}).finally((()=>{this._renderLoading(!1),this.close()}))}))}}const i=document.querySelector("#profile-edit-button"),n=(document.querySelector("#profile-edit-modal"),document.querySelector("#profile-add-modal"),document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector("#profile-title-input"),document.querySelector("#profile-description-input"),document.forms["add-card-form"]),o=(n.querySelector(".modal__input_title"),n.querySelector(".modal__input_url"),document.forms["modal-form"],document.querySelector(".cards__list"),document.querySelector("#card-template").content.firstElementChild,document.querySelector(".profile__add-button")),a=(document.querySelector("#modal-picture-form"),document.querySelector("#modal-image"),document.querySelector("#modal-title-image"),document.querySelectorAll(".modal__close"),document.querySelector(".profile__image"),document.querySelector(".profile__edit-icon"));document.getElementById("modal-delete-card"),document.querySelector(".card__trash-button"),document.getElementById("modal-close-button"),document.getElementById("modal-confirm-delete");const l={};var d;d={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},Array.from(document.querySelectorAll(d.formSelector)).forEach((e=>{const r=new t(d,e),s=e.getAttribute("name");l[s]=r,r.enableValidation()}));const c=l["add-card-form"],h=l["edit-card-form"],u=l["edit-avatar-form"],m=new s("#profile-edit-modal",(function(e){let{inputData:t}=e;return k.updateUserInfo({name:t.name,about:t.description}).then((e=>{v.setUserInfo({name:e.name,description:e.about}),m.close()})).catch((e=>{console.error("Error updating profile:",e)}))}),!1,h),_=new s("#profile-add-modal",(function(e){let{inputData:t,form:r}=e;return k.addCard({name:t.name,link:t.link}).then((e=>{y(e),r.reset(),c.toggleButtonState(),_.close()})).catch((e=>{console.error("Error adding card:",e)}))}),c),p=new s("#avatar-edit-modal",(function(e){let{inputData:t,form:r}=e;const s=t.avatar;return k.updateAvatar(s).then((e=>{v.setUserInfo({avatar:e.avatar}),r.reset()})).catch((e=>{console.error("Failed to update avatar:",e)}))}),u),f=new class extends r{constructor(e){super(e),this._imageElement=this._popupElement.querySelector(".modal__image"),this._imageCaption=this._popupElement.querySelector("#modal-title-image")}open(e){e&&e.link&&e.name?(this._imageElement.src=e.link,this._imageElement.alt=e.name,this._imageCaption.textContent=e.name,super.open()):console.error("Incorrect cardData passed to PopupWithImage",e)}}("#modal-picture-form"),E=new class{constructor(e,t){let{renderer:r}=e;this._renderer=r,this._element=document.querySelector(t)}renderItems(e){e.forEach((e=>this._renderer(e)))}addItem(e){this._element.prepend(e)}}({items:[],renderer:y},".cards__list"),v=new class{constructor(e){let{profileName:t,jobElement:r,avatarElement:s}=e;this._profileName=document.querySelector(t),this._jobElement=document.querySelector(r),this._avatarElement=document.querySelector(s)}getUserInfo(){return{name:this._profileName.textContent,description:this._jobElement.textContent,avatar:this._avatarElement.src}}setUserInfo(e){let{name:t,description:r,avatar:s}=e;t&&r&&(this._profileName.textContent=t,this._jobElement.textContent=r),s&&(this._avatarElement.src=s)}}({profileName:".profile__title",jobElement:".profile__description",avatarElement:".profile__image"}),L=new class extends r{constructor(e,t){super(e),this._handleDeleteConfirm=null}setHandleConfirm(e){this._handleDeleteConfirm=e}setEventListeners(){super.setEventListeners(),this._confirmButton=this._popupElement.querySelector(".modal__button_confirm"),this._confirmButton.addEventListener("click",(()=>{this._handleDeleteConfirm(),this.close()}))}}("#modal-delete-card"),k=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_handleResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then(this._handleResponse)}updateUserInfo(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._handleResponse)}updateUserAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})}).then(this._handleResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{method:"GET",headers:this._headers}).then(this._handleResponse)}addCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:{...this._headers,"Content-Type":"application/json"},body:JSON.stringify({name:e.name,link:e.link})}).then(this._handleResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}removeLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}updateAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"49047f75-cbce-49b8-982b-1a6a5af2c35f","Content-Type":"application/json"}});function y(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"addItem";const s=new e({name:(i=t).name,link:i.link,id:i._id,isLiked:i.isLiked},"#card-template",S,b,g).getView();var i;E[r](s)}function S(e){f.open(e)}function b(e,t){L.setHandleConfirm((()=>{k.deleteCard(e).then((e=>{console.log(e.message),t.handleDeleteCard()})).catch((e=>console.error("Error deleting card:",e)))})),L.open()}function g(e,t){t._isLiked?k.removeLike(e).then((e=>{t.setCardLike(e.isLiked)})).catch((e=>console.error("Error removing like:",e))):k.addLike(e).then((e=>{t.setCardLike(e.isLiked)})).catch((e=>console.error("Error adding like:",e)))}f.setEventListeners(),m.setEventListeners(),_.setEventListeners(),L.setEventListeners(),p.setEventListeners(),k.getUserInfo().then((e=>{v.setUserInfo({name:e.name,description:e.about,avatar:e.avatar})})).catch((e=>{console.error("Error fetching user info:",e)})),k.getInitialCards().then((e=>{E.renderItems(e)})).catch((e=>{console.error("Error fetching cards:",e)})),i.addEventListener("click",(()=>{h.resetValidation();const e=v.getUserInfo();m.setInputValues({name:e.name,description:e.description}),m.open()})),o.addEventListener("click",(()=>{_.open()})),a.addEventListener("click",(()=>{p.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFFL0JyRSxPQUFPQyxJQUNOQyxRQUFRRCxNQUFNLHdCQUF5QkEsRUFBTSxJQXNHakQ3QixFQUFrQi9GLGlCQUFpQixTQUFTLEtBQzFDK0csRUFBeUJ4RCxrQkFDekIsTUFBTTBJLEVBQVd4RSxFQUFTa0MsY0FDMUIxQyxFQUFhMUIsZUFBZSxDQUMxQnBHLEtBQU04TSxFQUFTOU0sS0FDZm1JLFlBQWEyRSxFQUFTM0UsY0FHeEJMLEVBQWF0RCxNQUFNLElBa0NyQnVDLEVBQWlCbEcsaUJBQWlCLFNBQVMsS0FDekM4SCxFQUFhbkUsTUFBTSxJQUdyQnlDLEVBQWVwRyxpQkFBaUIsU0FBUyxLQUN2Q21JLEVBQVl4RSxNQUFNLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvdXRpbHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRGVsZXRlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIGNhcmREYXRhLFxyXG4gICAgY2FyZFNlbGVjdG9yLFxyXG4gICAgaGFuZGxlUHJldmlld1BpY3R1cmUsXHJcbiAgICBoYW5kbGVEZWxldGVDYXJkQ2xpY2ssXHJcbiAgICBoYW5kbGVMaWtlQ2xpY2tcclxuICApIHtcclxuICAgIHRoaXMuX25hbWUgPSBjYXJkRGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGNhcmREYXRhLmxpbms7XHJcbiAgICB0aGlzLl9pZCA9IGNhcmREYXRhLmlkO1xyXG4gICAgdGhpcy5faXNMaWtlZCA9IGNhcmREYXRhLmlzTGlrZWQgfHwgZmFsc2U7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVQcmV2aWV3UGljdHVyZSA9IGhhbmRsZVByZXZpZXdQaWN0dXJlO1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZENsaWNrID0gaGFuZGxlRGVsZXRlQ2FyZENsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sodGhpcy5faWQsIHRoaXMpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fdHJhc2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZENsaWNrKHRoaXMuX2lkLCB0aGlzKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVQcmV2aWV3UGljdHVyZSh7IG5hbWU6IHRoaXMuX25hbWUsIGxpbms6IHRoaXMuX2xpbmsgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGhhbmRsZURlbGV0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICAgIHRoaXMuY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgc2V0Q2FyZExpa2UoaXNMaWtlZCkge1xyXG4gICAgdGhpcy5faXNMaWtlZCA9IGlzTGlrZWQ7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlSWNvbigpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUxpa2VJY29uKCkge1xyXG4gICAgaWYgKHRoaXMuX2lzTGlrZWQpIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgcmV0dXJuIGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgfVxyXG4gIGdldFZpZXcoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl90cmFzaEJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdHJhc2gtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIikudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5zZXRDYXJkTGlrZSh0aGlzLl9pc0xpa2VkLCB0aGlzLl9saWtlcyk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcbn1cclxuIiwiY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbCkge1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWw7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbCwgdmFsaWRhdGlvbk1lc3NhZ2UpIHtcclxuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xyXG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpIHtcclxuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xyXG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuICF0aGlzLl9pbnB1dExpc3QuZXZlcnkoKGlucHV0RWwpID0+IGlucHV0RWwudmFsaWRpdHkudmFsaWQpO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XHJcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgICB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XHJcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChldmVudCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcclxuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIC8vIGNvbnNvbGUubG9nKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICAvL29wZW5cclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICAvL2Nsb3NlXHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldmVudCkgPT4ge1xyXG4gICAgLy9saXN0ZW4gZm9yIGVzYyBidXR0b25cclxuICAgIGlmIChldmVudC5rZXkgPT09IFwiRXNjYXBlXCIgJiYgZXZlbnQudHlwZSA9PT0gXCJrZXlkb3duXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy9zZXRzIGV2ZW50IGxpc3RlbmVyc1xyXG4gICAgdGhpcy5jbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcclxuICAgIHRoaXMuY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGUpID0+IHtcclxuICAgICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQsIHNob3VsZFJlc2V0QmVmb3JlU3VibWl0ID0gdHJ1ZSkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcclxuICAgIHRoaXMuX2luaXRpYWxCdXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xyXG4gICAgdGhpcy5fc2hvdWxkUmVzZXRCZWZvcmVTdWJtaXQgPSBzaG91bGRSZXNldEJlZm9yZVN1Ym1pdDtcclxuICB9XHJcblxyXG4gIC8vIE92ZXJyaWRlIG9wZW4gdG8gcmVzZXQgZm9ybVxyXG4gIG9wZW4oKSB7XHJcbiAgICBpZiAodGhpcy5fc2hvdWxkUmVzZXRCZWZvcmVTdWJtaXQpIHtcclxuICAgICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XHJcbiAgICB9XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG5cclxuICBnZXRGb3JtKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3BvcHVwRm9ybTtcclxuICB9XHJcblxyXG4gIC8vIENvbGxlY3RzIGRhdGEgZnJvbSBhbGwgaW5wdXQgZmllbGRzXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgLy8gQ3JlYXRlIGFuIG9iamVjdCB0byBob2xkIHRoZSBpbnB1dCB2YWx1ZXNcclxuICAgIHRoaXMuX2lucHV0VmFsdWVzID0ge307XHJcblxyXG4gICAgLy8gSXRlcmF0ZSBvdmVyIGV2ZXJ5IGlucHV0IGFuZCBhZGQgdG8gdGhlIGlucHV0VmFsdWVzIG9iamVjdFxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIHRoaXMuX2lucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5faW5wdXRWYWx1ZXM7XHJcbiAgfVxyXG5cclxuICBzZXRJbnB1dFZhbHVlcyhkYXRhKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgLy8gSGVyZSB5b3UgaW5zZXJ0IHRoZSBgdmFsdWVgIGJ5IHRoZSBgbmFtZWAgb2YgdGhlIGlucHV0XHJcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX3JlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9pbml0aWFsQnV0dG9uVGV4dDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX3JlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoe1xyXG4gICAgICAgIGlucHV0RGF0YTogdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSxcclxuICAgICAgICBmb3JtOiB0aGlzLmdldEZvcm0oKSxcclxuICAgICAgfSkuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuLy8gY29uc3QgbmV3Q2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjcHJvZmlsZS1hZGQtbW9kYWxcIiwgKCkgPT4ge1xyXG4vLyAgIC8vIGhhbmRsZWZvcm1cclxuLy8gfSk7XHJcblxyXG4vLyBuZXdDYXJkUG9wdXAub3BlbigpO1xyXG5cclxuLy8gbmV3Q2FyZFBvcHVwLmNsb3NlKCk7XHJcbiIsImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAge1xyXG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhdGVtYXIuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcclxuICB9LFxyXG5dO1xyXG5cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1hZGQtbW9kYWxcIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1pbnB1dFwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtRWxlbWVudCA9IGRvY3VtZW50LmZvcm1zW1wiYWRkLWNhcmQtZm9ybVwiXTtcclxuZXhwb3J0IGNvbnN0IGNhcmRUaXRsZUlucHV0ID0gYWRkQ2FyZEZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIubW9kYWxfX2lucHV0X3RpdGxlXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRVcmxJbnB1dCA9XHJcbiAgYWRkQ2FyZEZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2lucHV0X3VybFwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IGRvY3VtZW50LmZvcm1zW1wibW9kYWwtZm9ybVwiXTtcclxuXHJcbmV4cG9ydCBjb25zdCBjYXJkc1dyYXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xyXG5leHBvcnQgY29uc3QgY2FyZFRlbXBsYXRlID1cclxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIikuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZDtcclxuZXhwb3J0IGNvbnN0IGFkZE5ld0NhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBwcmV2aWV3SW1hZ2VNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtcGljdHVyZS1mb3JtXCIpO1xyXG5leHBvcnQgY29uc3QgaW1hZ2VFbGVtZW50TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWltYWdlXCIpO1xyXG5leHBvcnQgY29uc3QgdGl0bGVFbGVtZW50TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLXRpdGxlLWltYWdlXCIpO1xyXG5leHBvcnQgY29uc3QgY2xvc2VCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9fY2xvc2VcIik7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2VcIik7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJFZGl0SWNvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1pY29uXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IHNlbGVjdG9ycyA9IHtcclxuICBjYXJkTGlzdDogXCIuY2FyZHNfX2xpc3RcIixcclxuICBjYXJkVGVtcGxhdGU6IFwiLmNhcmQtdGVtcGxhdGVcIixcclxuICBwcmV2aWV3UG9wdXA6IFwiI21vZGFsLXBpY3R1cmUtZm9ybVwiLFxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25TZXR0aW5ncyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZGVsZXRlTW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1vZGFsLWRlbGV0ZS1jYXJkXCIpO1xyXG5leHBvcnQgY29uc3QgZGVsZXRlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190cmFzaC1idXR0b25cIik7IC8vIEFkanVzdCBzZWxlY3RvciBhcyBuZWVkZWRcclxuZXhwb3J0IGNvbnN0IGNsb3NlQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtb2RhbC1jbG9zZS1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBjb25maXJtRGVsZXRlQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXHJcbiAgXCJtb2RhbC1jb25maXJtLWRlbGV0ZVwiXHJcbik7XHJcbiIsImltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IHsgdmFsaWRhdGlvblNldHRpbmdzLCBzZWxlY3RvcnMgfSBmcm9tIFwiLi4vdXRpbHMvdXRpbHMuanNcIjtcclxuaW1wb3J0IHsgcHJvZmlsZUVkaXRCdXR0b24sIGFkZE5ld0NhcmRCdXR0b24gfSBmcm9tIFwiLi4vdXRpbHMvdXRpbHMuanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aERlbGV0ZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhEZWxldGUuanNcIjtcclxuaW1wb3J0IHsgYXZhdGFySW1hZ2UgfSBmcm9tIFwiLi4vdXRpbHMvdXRpbHMuanNcIjtcclxuaW1wb3J0IHsgYXZhdGFyRWRpdEljb24gfSBmcm9tIFwiLi4vdXRpbHMvdXRpbHMuanNcIjtcclxuXHJcbmNvbnN0IGNhcmREYXRhID0ge1xyXG4gIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxyXG59O1xyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYWxpZGF0aW9uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XHJcblxyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKHZhbGlkYXRpb25TZXR0aW5ncykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodmFsaWRhdGlvblNldHRpbmdzLmZvcm1TZWxlY3RvcilcclxuICApO1xyXG5cclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBmb3JtRWxlbWVudCk7XHJcblxyXG4gICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO1xyXG5cclxuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcclxuICAgIHZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5lbmFibGVWYWxpZGF0aW9uKHZhbGlkYXRpb25TZXR0aW5ncyk7XHJcblxyXG4vLyBBY2Nlc3MgZWFjaCB2YWxpZGF0b3IgYnkgZm9ybSBuYW1lXHJcbmNvbnN0IGFkZENhcmRGb3JtVmFsaWRhdG9yID0gZm9ybVZhbGlkYXRvcnNbXCJhZGQtY2FyZC1mb3JtXCJdO1xyXG5jb25zdCBlZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IgPSBmb3JtVmFsaWRhdG9yc1tcImVkaXQtY2FyZC1mb3JtXCJdO1xyXG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gZm9ybVZhbGlkYXRvcnNbXCJlZGl0LWF2YXRhci1mb3JtXCJdO1xyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZSBpbnN0YW5jZXMgb2YgdGhlIGNsYXNzZXMgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbi8vcG9wdXB3aXRoZm9ybVxyXG5cclxuY29uc3QgcHJvZmlsZU1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIsXHJcbiAgaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQsXHJcbiAgZmFsc2UsXHJcbiAgZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yXHJcbik7XHJcblxyXG5jb25zdCBhZGRDYXJkTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNwcm9maWxlLWFkZC1tb2RhbFwiLFxyXG4gIGhhbmRsZUFkZENhcmRTdWJtaXQsXHJcbiAgYWRkQ2FyZEZvcm1WYWxpZGF0b3JcclxuKTtcclxuXHJcbmNvbnN0IGF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIjYXZhdGFyLWVkaXQtbW9kYWxcIixcclxuICBoYW5kbGVBdmF0YXJTdWJtaXQsXHJcbiAgYXZhdGFyRm9ybVZhbGlkYXRvclxyXG4pO1xyXG5cclxuLy9wb3B1cHdpdGhpbWFnZVxyXG5cclxuY29uc3QgY2FyZFByZXZpZXdQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShzZWxlY3RvcnMucHJldmlld1BvcHVwKTtcclxuXHJcbi8vc2VjdGlvblxyXG5jb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gIHtcclxuICAgIGl0ZW1zOiBbXSxcclxuICAgIHJlbmRlcmVyOiByZW5kZXJDYXJkLFxyXG4gIH0sXHJcbiAgc2VsZWN0b3JzLmNhcmRMaXN0XHJcbik7XHJcblxyXG4vLyB1c2VyaW5mb1xyXG4vL2NvbW1lbnRcclxuXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcclxuICBwcm9maWxlTmFtZTogXCIucHJvZmlsZV9fdGl0bGVcIixcclxuICBqb2JFbGVtZW50OiBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxyXG4gIGF2YXRhckVsZW1lbnQ6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXHJcbn0pO1xyXG5cclxuLy8gZGVsZXRlXHJcbmV4cG9ydCBjb25zdCBkZWxldGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhEZWxldGUoXCIjbW9kYWwtZGVsZXRlLWNhcmRcIik7XHJcblxyXG4vL2luaXRpYWxpemUgYXBpIGNsYXNzXHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCI0OTA0N2Y3NS1jYmNlLTQ5YjgtOTgyYi0xYTZhNWFmMmMzNWZcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuLy9pbml0aWFsaXplIGFsbCBteSBpbnN0YW5jZXNcclxuLy8gY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoKTtcclxuY2FyZFByZXZpZXdQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5wcm9maWxlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuYWRkQ2FyZE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmRlbGV0ZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmF2YXRhclBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgaW5pdGlhdGUgdGhlIGFjdHVhbCBBUEkgcmVxdWVzdCAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuYXBpXHJcbiAgLmdldFVzZXJJbmZvKClcclxuICAudGhlbigodXNlckluZm9EYXRhKSA9PiB7XHJcbiAgICAvLyBTZXQgdGhlIHVzZXIncyBpbmZvIGluIHRoZSBVc2VySW5mbyBpbnN0YW5jZVxyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xyXG4gICAgICBuYW1lOiB1c2VySW5mb0RhdGEubmFtZSxcclxuICAgICAgZGVzY3JpcHRpb246IHVzZXJJbmZvRGF0YS5hYm91dCxcclxuICAgICAgYXZhdGFyOiB1c2VySW5mb0RhdGEuYXZhdGFyLFxyXG4gICAgfSk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgdXNlciBpbmZvOlwiLCBlcnJvcik7XHJcbiAgfSk7XHJcblxyXG5hcGlcclxuICAuZ2V0SW5pdGlhbENhcmRzKClcclxuICAudGhlbigoY2FyZHMpID0+IHtcclxuICAgIC8vIFJlbmRlciB0aGUgaW5pdGlhbCBzZXQgb2YgY2FyZHMgdXNpbmcgdGhlIFNlY3Rpb24gaW5zdGFuY2VcclxuICAgIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKGNhcmRzKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBjYXJkczpcIiwgZXJyb3IpO1xyXG4gIH0pO1xyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRnVuY3Rpb25zICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuZnVuY3Rpb24gcmVuZGVyQ2FyZChpdGVtLCBtZXRob2QgPSBcImFkZEl0ZW1cIikge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlZENhcmQoaXRlbSk7XHJcbiAgY2FyZFNlY3Rpb25bbWV0aG9kXShjYXJkRWxlbWVudCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByZXZpZXdQaWN0dXJlKGNhcmREYXRhKSB7XHJcbiAgY2FyZFByZXZpZXdQb3B1cC5vcGVuKGNhcmREYXRhKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlZENhcmQoY2FyZERhdGEpIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgICB7XHJcbiAgICAgIG5hbWU6IGNhcmREYXRhLm5hbWUsXHJcbiAgICAgIGxpbms6IGNhcmREYXRhLmxpbmssXHJcbiAgICAgIGlkOiBjYXJkRGF0YS5faWQsXHJcbiAgICAgIGlzTGlrZWQ6IGNhcmREYXRhLmlzTGlrZWQsXHJcbiAgICB9LFxyXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG4gICAgaGFuZGxlUHJldmlld1BpY3R1cmUsXHJcbiAgICBoYW5kbGVEZWxldGVDYXJkQ2xpY2ssXHJcbiAgICBoYW5kbGVMaWtlQ2xpY2tcclxuICApO1xyXG4gIHJldHVybiBjYXJkLmdldFZpZXcoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQoeyBpbnB1dERhdGEgfSkge1xyXG4gIC8vIFNlbmQgdGhlIHByb2ZpbGUgZGF0YSB0byB0aGUgc2VydmVyXHJcbiAgcmV0dXJuIGFwaVxyXG4gICAgLnVwZGF0ZVVzZXJJbmZvKHtcclxuICAgICAgbmFtZTogaW5wdXREYXRhLm5hbWUsXHJcbiAgICAgIGFib3V0OiBpbnB1dERhdGEuZGVzY3JpcHRpb24sXHJcbiAgICB9KVxyXG4gICAgLnRoZW4oKHVwZGF0ZWRVc2VySW5mbykgPT4ge1xyXG4gICAgICAvLyBVcGRhdGUgdGhlIHByb2ZpbGUgaW4gdGhlIFVJIG9ubHkgYWZ0ZXIgcmVjZWl2aW5nIGEgc3VjY2Vzc2Z1bCByZXNwb25zZVxyXG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgICAgbmFtZTogdXBkYXRlZFVzZXJJbmZvLm5hbWUsXHJcbiAgICAgICAgZGVzY3JpcHRpb246IHVwZGF0ZWRVc2VySW5mby5hYm91dCxcclxuICAgICAgfSk7XHJcbiAgICAgIHByb2ZpbGVNb2RhbC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHVwZGF0aW5nIHByb2ZpbGU6XCIsIGVycm9yKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkU3VibWl0KHsgaW5wdXREYXRhLCBmb3JtIH0pIHtcclxuICAvLyBTZW5kIHRoZSBuZXcgY2FyZCBkYXRhIHRvIHRoZSBzZXJ2ZXJcclxuICByZXR1cm4gYXBpXHJcbiAgICAuYWRkQ2FyZCh7XHJcbiAgICAgIG5hbWU6IGlucHV0RGF0YS5uYW1lLFxyXG4gICAgICBsaW5rOiBpbnB1dERhdGEubGluayxcclxuICAgIH0pXHJcbiAgICAudGhlbigobmV3Q2FyZERhdGEpID0+IHtcclxuICAgICAgLy8gUmVuZGVyIHRoZSBjYXJkIG9ubHkgYWZ0ZXIgcmVjZWl2aW5nIGEgc3VjY2Vzc2Z1bCByZXNwb25zZSBmcm9tIHRoZSBzZXJ2ZXJcclxuICAgICAgcmVuZGVyQ2FyZChuZXdDYXJkRGF0YSk7XHJcbiAgICAgIGZvcm0ucmVzZXQoKTtcclxuICAgICAgYWRkQ2FyZEZvcm1WYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgYWRkQ2FyZE1vZGFsLmNsb3NlKCk7IC8vIENsb3NlIHRoZSBhZGQgY2FyZCBtb2RhbFxyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGFkZGluZyBjYXJkOlwiLCBlcnJvcik7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZENsaWNrKGNhcmRJZCwgY2FyZEluc3RhbmNlKSB7XHJcbiAgZGVsZXRlUG9wdXAuc2V0SGFuZGxlQ29uZmlybSgoKSA9PiB7XHJcbiAgICBhcGlcclxuICAgICAgLmRlbGV0ZUNhcmQoY2FyZElkKVxyXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGRhdGEubWVzc2FnZSk7IC8vIEV4cGVjdGVkIHRvIGxvZyBcIlRoaXMgcG9zdCBoYXMgYmVlbiBkZWxldGVkXCJcclxuICAgICAgICBjYXJkSW5zdGFuY2UuaGFuZGxlRGVsZXRlQ2FyZCgpOyAvLyBSZW1vdmUgY2FyZCBmcm9tIERPTVxyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3IgZGVsZXRpbmcgY2FyZDpcIiwgZXJyb3IpKTtcclxuICB9KTtcclxuXHJcbiAgZGVsZXRlUG9wdXAub3BlbigpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVMaWtlQ2xpY2soY2FyZElkLCBjYXJkSW5zdGFuY2UpIHtcclxuICBpZiAoY2FyZEluc3RhbmNlLl9pc0xpa2VkKSB7XHJcbiAgICBhcGlcclxuICAgICAgLnJlbW92ZUxpa2UoY2FyZElkKVxyXG4gICAgICAudGhlbigodXBkYXRlZERhdGEpID0+IHtcclxuICAgICAgICBjYXJkSW5zdGFuY2Uuc2V0Q2FyZExpa2UodXBkYXRlZERhdGEuaXNMaWtlZCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IGNvbnNvbGUuZXJyb3IoXCJFcnJvciByZW1vdmluZyBsaWtlOlwiLCBlcnJvcikpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBhcGlcclxuICAgICAgLmFkZExpa2UoY2FyZElkKVxyXG4gICAgICAudGhlbigodXBkYXRlZERhdGEpID0+IHtcclxuICAgICAgICBjYXJkSW5zdGFuY2Uuc2V0Q2FyZExpa2UodXBkYXRlZERhdGEuaXNMaWtlZCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IGNvbnNvbGUuZXJyb3IoXCJFcnJvciBhZGRpbmcgbGlrZTpcIiwgZXJyb3IpKTtcclxuICB9XHJcbn1cclxuXHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGNvbnN0IHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBwcm9maWxlTW9kYWwuc2V0SW5wdXRWYWx1ZXMoe1xyXG4gICAgbmFtZTogdXNlckRhdGEubmFtZSxcclxuICAgIGRlc2NyaXB0aW9uOiB1c2VyRGF0YS5kZXNjcmlwdGlvbixcclxuICB9KTtcclxuXHJcbiAgcHJvZmlsZU1vZGFsLm9wZW4oKTtcclxufSk7XHJcblxyXG4vLyBEZWZpbmUgdGhlIGhhbmRsZUF2YXRhclN1Ym1pdCBmdW5jdGlvblxyXG4vLyBmdW5jdGlvbiBoYW5kbGVBdmF0YXJTdWJtaXQoeyBpbnB1dERhdGEsIGZvcm0gfSkge1xyXG4vLyAgIGNvbnN0IGF2YXRhclVybCA9IGlucHV0RGF0YS5hdmF0YXI7IC8vIEdldCB0aGUgVVJMIGZyb20gdGhlIGZvcm1cclxuXHJcbi8vICAgYXBpXHJcbi8vICAgICAudXBkYXRlQXZhdGFyKGF2YXRhclVybClcclxuLy8gICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbi8vICAgICAgIC8vIFVwZGF0ZSB0aGUgYXZhdGFyIGltYWdlIHNyYyBvbiB0aGUgcGFnZVxyXG4vLyAgICAgICBhdmF0YXJJbWFnZS5zcmMgPSBkYXRhLmF2YXRhcjtcclxuLy8gICAgICAgZm9ybS5yZXNldCgpO1xyXG4vLyAgICAgfSlcclxuLy8gICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuLy8gICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byB1cGRhdGUgYXZhdGFyOlwiLCBlcnJvcik7XHJcbi8vICAgICB9KTtcclxuLy8gfVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyU3VibWl0KHsgaW5wdXREYXRhLCBmb3JtIH0pIHtcclxuICBjb25zdCBhdmF0YXJVcmwgPSBpbnB1dERhdGEuYXZhdGFyOyAvLyBHZXQgdGhlIFVSTCBmcm9tIHRoZSBmb3JtXHJcblxyXG4gIHJldHVybiBhcGlcclxuICAgIC51cGRhdGVBdmF0YXIoYXZhdGFyVXJsKVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oeyBhdmF0YXI6IGRhdGEuYXZhdGFyIH0pO1xyXG4gICAgICBmb3JtLnJlc2V0KCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHVwZGF0ZSBhdmF0YXI6XCIsIGVycm9yKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vLyBhZGQgbmV3IGNhcmQgYnV0dG9uXHJcbmFkZE5ld0NhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhZGRDYXJkTW9kYWwub3BlbigpO1xyXG59KTtcclxuXHJcbmF2YXRhckVkaXRJY29uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgYXZhdGFyUG9wdXAub3BlbigpO1xyXG59KTtcclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2ltYWdlRWxlbWVudCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2ltYWdlQ2FwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLXRpdGxlLWltYWdlXCIpO1xyXG4gIH1cclxuICBvcGVuKGNhcmREYXRhKSB7XHJcbiAgICBpZiAoIWNhcmREYXRhIHx8ICFjYXJkRGF0YS5saW5rIHx8ICFjYXJkRGF0YS5uYW1lKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJJbmNvcnJlY3QgY2FyZERhdGEgcGFzc2VkIHRvIFBvcHVwV2l0aEltYWdlXCIsIGNhcmREYXRhKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LnNyYyA9IGNhcmREYXRhLmxpbms7XHJcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuYWx0ID0gY2FyZERhdGEubmFtZTtcclxuICAgIHRoaXMuX2ltYWdlQ2FwdGlvbi50ZXh0Q29udGVudCA9IGNhcmREYXRhLm5hbWU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgcmVuZGVyZXIgfSwgc2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICByZW5kZXJJdGVtcyhkYXRhKSB7XHJcbiAgICBkYXRhLmZvckVhY2goKGl0ZW0pID0+IHRoaXMuX3JlbmRlcmVyKGl0ZW0pKTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oaXRlbSkge1xyXG4gICAgdGhpcy5fZWxlbWVudC5wcmVwZW5kKGl0ZW0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoeyBwcm9maWxlTmFtZSwgam9iRWxlbWVudCwgYXZhdGFyRWxlbWVudCB9KSB7XHJcbiAgICB0aGlzLl9wcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZU5hbWUpO1xyXG4gICAgdGhpcy5fam9iRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iRWxlbWVudCk7XHJcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJFbGVtZW50KTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICBhdmF0YXI6IHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgZGVzY3JpcHRpb24sIGF2YXRhciB9KSB7XHJcbiAgICAvLyBjb25zb2xlLmxvZyhcIlNldHRpbmcgVXNlciBJbmZvOiBcIiwgeyBuYW1lLCBkZXNjcmlwdGlvbiB9KTtcclxuICAgIGlmIChuYW1lICYmIGRlc2NyaXB0aW9uKSB7XHJcbiAgICAgIHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgICAgdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChhdmF0YXIpIHtcclxuICAgICAgdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMgPSBhdmF0YXI7XHJcbiAgICB9XHJcbiAgICAvLyBjb25zb2xlLmxvZyhcIlVwZGF0ZWQgTmFtZTogXCIsIHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50KTsgLy8gRGVidWcgbG9nXHJcbiAgICAvLyBjb25zb2xlLmxvZyhcIlVwZGF0ZWQgRGVzY3JpcHRpb246IFwiLCB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhEZWxldGUgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRGVsZXRlQ29uZmlybSkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDb25maXJtID0gbnVsbDtcclxuICB9XHJcblxyXG4gIHNldEhhbmRsZUNvbmZpcm0oaGFuZGxlQ29uZmlybSkge1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ29uZmlybSA9IGhhbmRsZUNvbmZpcm07XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgLy8gQWRkIGFuIGV2ZW50IGxpc3RlbmVyIGZvciB0aGUgZGVsZXRlIGNvbmZpcm1hdGlvbiBidXR0b25cclxuICAgIHRoaXMuX2NvbmZpcm1CdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIubW9kYWxfX2J1dHRvbl9jb25maXJtXCJcclxuICAgICk7XHJcbiAgICB0aGlzLl9jb25maXJtQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNvbmZpcm0oKTtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IG9wdGlvbnMuYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICAvLyBIYW5kbGUgc2VydmVyIHJlc3BvbnNlc1xyXG5cclxuICBfaGFuZGxlUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuXHJcbiAgLy8gR2V0IHRoZSBjdXJyZW50IHVzZXIncyBpbmZvXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgLy8gVXBkYXRlIHVzZXIncyBwcm9maWxlIGluZm9ybWF0aW9uXHJcbiAgdXBkYXRlVXNlckluZm8oZGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IGRhdGEubmFtZSxcclxuICAgICAgICBhYm91dDogZGF0YS5hYm91dCxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIC8vIFVwZGF0ZSB1c2VyJ3MgYXZhdGFyXHJcbiAgdXBkYXRlVXNlckF2YXRhcihkYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycywgLy8gVG9rZW4gaXMgaW5jbHVkZWQgaGVyZVxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyOiBkYXRhLmF2YXRhcixcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBhZGRDYXJkKGRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIC4uLnRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgbGluazogZGF0YS5saW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIC8vIGNvbnN0IHVybCA9IGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWA7XHJcbiAgICAvLyBjb25zb2xlLmxvZyhcIkRlbGV0aW5nIGNhcmQgYXQgVVJMOlwiLCB1cmwpOyAvLyBMb2cgVVJMIHRvIHZlcmlmeVxyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmICghcmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBBZGQgYSBsaWtlXHJcbiAgYWRkTGlrZShjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAoIXJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTsgLy8gUmV0dXJucyB1cGRhdGVkIGNhcmQgZGF0YSB3aXRoIGlzTGlrZWQgZmllbGRcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gUmVtb3ZlIGEgbGlrZVxyXG4gIHJlbW92ZUxpa2UoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKCFyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7IC8vIFJldHVybnMgdXBkYXRlZCBjYXJkIGRhdGEgd2l0aCBpc0xpa2VkIGZpZWxkXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUF2YXRhcihhdmF0YXJVcmwpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGF2YXRhcjogYXZhdGFyVXJsIH0pLFxyXG4gICAgfSkudGhlbigocmVzcG9uc2UpID0+IHtcclxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsImNhcmREYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlUHJldmlld1BpY3R1cmUiLCJoYW5kbGVEZWxldGVDYXJkQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJ0aGlzIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2lkIiwiaWQiLCJfaXNMaWtlZCIsImlzTGlrZWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZVByZXZpZXdQaWN0dXJlIiwiX2hhbmRsZURlbGV0ZUNhcmRDbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfbGlrZUJ1dHRvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJfdHJhc2hCdXR0b24iLCJfY2FyZEltYWdlIiwiaGFuZGxlRGVsZXRlQ2FyZCIsIl9jYXJkRWxlbWVudCIsInJlbW92ZSIsImNhcmRFbGVtZW50Iiwic2V0Q2FyZExpa2UiLCJfaGFuZGxlTGlrZUljb24iLCJjbGFzc0xpc3QiLCJhZGQiLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiZ2V0VmlldyIsInNyYyIsImFsdCIsInRleHRDb250ZW50IiwiX2xpa2VzIiwic2V0dGluZ3MiLCJmb3JtRWwiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybSIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWwiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImVycm9yTWVzc2FnZUVsIiwiX2hpZGVJbnB1dEVycm9yIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJfaGFzSW52YWxpZElucHV0IiwiX3N1Ym1pdEJ1dHRvbiIsImRpc2FibGVkIiwiX2lucHV0TGlzdCIsImV2ZXJ5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImV2ZW50IiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwicmVzZXRWYWxpZGF0aW9uIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJ0eXBlIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJjbG9zZUJ1dHRvbiIsImUiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic2hvdWxkUmVzZXRCZWZvcmVTdWJtaXQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9pbml0aWFsQnV0dG9uVGV4dCIsIl9zaG91bGRSZXNldEJlZm9yZVN1Ym1pdCIsInJlc2V0IiwiZ2V0Rm9ybSIsIl9nZXRJbnB1dFZhbHVlcyIsIl9pbnB1dFZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJzZXRJbnB1dFZhbHVlcyIsImRhdGEiLCJfcmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsImV2dCIsImlucHV0RGF0YSIsImZvcm0iLCJmaW5hbGx5IiwicHJvZmlsZUVkaXRCdXR0b24iLCJhZGRDYXJkRm9ybUVsZW1lbnQiLCJmb3JtcyIsImFkZE5ld0NhcmRCdXR0b24iLCJmaXJzdEVsZW1lbnRDaGlsZCIsImF2YXRhckVkaXRJY29uIiwiZ2V0RWxlbWVudEJ5SWQiLCJmb3JtVmFsaWRhdG9ycyIsInZhbGlkYXRpb25TZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImZvcm1FbGVtZW50IiwidmFsaWRhdG9yIiwiRm9ybVZhbGlkYXRvciIsImZvcm1OYW1lIiwiZ2V0QXR0cmlidXRlIiwiYWRkQ2FyZEZvcm1WYWxpZGF0b3IiLCJlZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IiLCJhdmF0YXJGb3JtVmFsaWRhdG9yIiwicHJvZmlsZU1vZGFsIiwiX3JlZiIsImFwaSIsInVwZGF0ZVVzZXJJbmZvIiwiYWJvdXQiLCJkZXNjcmlwdGlvbiIsInRoZW4iLCJ1cGRhdGVkVXNlckluZm8iLCJ1c2VySW5mbyIsInNldFVzZXJJbmZvIiwiY2F0Y2giLCJlcnJvciIsImNvbnNvbGUiLCJhZGRDYXJkTW9kYWwiLCJfcmVmMiIsImFkZENhcmQiLCJuZXdDYXJkRGF0YSIsInJlbmRlckNhcmQiLCJhdmF0YXJQb3B1cCIsIl9yZWYzIiwiYXZhdGFyVXJsIiwiYXZhdGFyIiwidXBkYXRlQXZhdGFyIiwiY2FyZFByZXZpZXdQb3B1cCIsIl9pbWFnZUVsZW1lbnQiLCJfaW1hZ2VDYXB0aW9uIiwiY2FyZFNlY3Rpb24iLCJzZWxlY3RvciIsInJlbmRlcmVyIiwiX3JlbmRlcmVyIiwiX2VsZW1lbnQiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwicHJlcGVuZCIsIml0ZW1zIiwicHJvZmlsZU5hbWUiLCJqb2JFbGVtZW50IiwiYXZhdGFyRWxlbWVudCIsIl9wcm9maWxlTmFtZSIsIl9qb2JFbGVtZW50IiwiX2F2YXRhckVsZW1lbnQiLCJnZXRVc2VySW5mbyIsImRlbGV0ZVBvcHVwIiwiaGFuZGxlRGVsZXRlQ29uZmlybSIsIl9oYW5kbGVEZWxldGVDb25maXJtIiwic2V0SGFuZGxlQ29uZmlybSIsImhhbmRsZUNvbmZpcm0iLCJfY29uZmlybUJ1dHRvbiIsIm9wdGlvbnMiLCJfYmFzZVVybCIsImJhc2VVcmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJfaGFuZGxlUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZmV0Y2giLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInVwZGF0ZVVzZXJBdmF0YXIiLCJnZXRJbml0aWFsQ2FyZHMiLCJkZWxldGVDYXJkIiwiY2FyZElkIiwiYWRkTGlrZSIsInJlbW92ZUxpa2UiLCJyZXNwb25zZSIsImF1dGhvcml6YXRpb24iLCJjYXJkSW5zdGFuY2UiLCJsb2ciLCJtZXNzYWdlIiwidXBkYXRlZERhdGEiLCJ1c2VySW5mb0RhdGEiLCJjYXJkcyIsInVzZXJEYXRhIl0sInNvdXJjZVJvb3QiOiIifQ==